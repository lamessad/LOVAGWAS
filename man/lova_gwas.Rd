% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/lova_gwas.R
\name{lova_gwas}
\alias{lova_gwas}
\title{LOVAGWAS: a locus direct effect estimation}
\usage{
lova_gwas(
  gwasY,
  betaX,
  tau_t,
  pcor = NULL,
  ny,
  plot_manhattan = FALSE,
  save_path = NULL
)
}
\arguments{
\item{gwasY}{Data frame of outcome GWAS summary statistics.
Must contain SNP IDs and effect estimates (any variant of b/beta/logodds etc.).
For Manhattan plotting, must also contain columns for chromosome (`CHR`)
and base position (`BP`).}

\item{betaX}{Data frame of exposure SNP effects: first column \code{SNP},
remaining columns are exposures.}

\item{tau_t}{Numeric vector of causal estimates for exposures
(length must match the number of exposure columns in \code{betaX} minus one).}

\item{pcor}{Optional correlation matrix with outcome in the first row/column
and exposures following. If \code{NULL}, it is computed from
\code{cbind(b, betaX_exposures)}.}

\item{ny}{Numeric; outcome GWAS sample size (must be > 0).}

\item{plot_manhattan}{Logical; if \code{TRUE}, generates Manhattan plots.}

\item{save_path}{Optional file path to save the plots as PNG; if \code{NULL},
plots are displayed to the active graphics device.}
}
\value{
A data frame containing:
  \describe{
    \item{b_c}{LOVAGWAS SNP effect (direct effect)}
    \item{se_c}{Adjusted standard error}
    \item{z_c}{Adjusted z-score}
    \item{pval_c}{Adjusted p-value}
    \item{missing_count}{Number of missing exposure effects replaced by 0}
    \item{missing_index}{Indices of missing exposures}
  }
}
\description{
Adjust GWAS SNP effects to estimate the direct genetic effect
using the Multivariable Mendelian Randomization Latent Outcome Variable
Approach (MVMR-LOVA).
Automatically detects column names such as `b`, `beta`, `BETA`, `effect`,
`logodds`, and their SE variants, as well as `SNP`, `CHR`, `BP`, `A1`, `A2`.
Optionally generates Manhattan plots (original vs adjusted) using qqman.
}
\details{
Direct effects are computed as \eqn{b_c = b_Y - B_X \tau_t}.
Standard errors use \eqn{se_c^2 = se_Y^2 + ||\tau_t||^2 / n_y - \mathrm{cov\_tmp}/n_y},
where \code{cov_tmp} aggregates outcome–exposure and exposure–exposure
correlation terms.
}
\examples{
# Simulated example with 100 SNPs and 2 exposures
set.seed(1)
n_snps <- 100
gwasY <- data.frame(
  SNP = paste0("rs", 1:n_snps),
  CHR = sample(1:22, n_snps, TRUE),
  BP  = sample(1e6:2e6, n_snps),
  A1  = sample(c("A", "C", "G", "T"), n_snps, TRUE),
  A2  = sample(c("A", "C", "G", "T"), n_snps, TRUE),
  BETA = rnorm(n_snps, 0, 0.05),
  SE   = runif(n_snps, 0.01, 0.03)
)

betaX <- data.frame(
  SNP = gwasY$SNP,
  exp1 = rnorm(n_snps, 0, 0.05),
  exp2 = rnorm(n_snps, 0, 0.05)
)

tau_t <- c(0.1, 0.2)

res <- lova_gwas(gwasY, betaX, tau_t, ny = 50000)
head(res)

}
